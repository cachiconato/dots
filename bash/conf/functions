#!/bin/bash

DOWNLOADS=$HOME/Downloads

myfind() {
  FFOUND_PWD=${PWD}
  FFOUND=($(find . -iname "*$2*" -type "$1"))
  print_found
}

print_found() {
  if [ "${#FFOUND[*]}" -eq 0 ]; then return; fi
  local index=1
  echo ${FFOUND[*]} | tr -s ' ' '\n' | while read line; do
  if [ -t 1 ]; then printf "% 4d " $index; fi
  echo $line
  index=$((index + 1))
done
}

lf() { print_found; }

ff() { myfind "f" "$1"; }

fd() { myfind "d" "$1"; }

fn() {
  [ ! -z ${FFOUND[$1-1]} ] && echo ${FFOUND_PWD}/${FFOUND[$1-1]};
}

vf() { vim $(fn "$1"); }

d() { cd $(dirname $(fn "$1")); }

c() { cat $(fn "$1"); }

ldown() { 
  echo $DOWNLOADS/$(ls -t $DOWNLOADS | head -1)
}

mdown() {
  mv "`ldown`" $1
}

cdown() {
  cp "`ldown`" $1
}

v() {
  servers="`vim --serverlist`"
  if [ "$servers" = "VIM" ]; then
    if [ $# -gt 0 ]; then
      vim --remote-silent $@
    else
      vim --remote-send :new\<cr\>
    fi
  else
    vim $@
  fi
}

resolve_ecom() {
    gg;
    cd build/buildeng;
    sed 's/<env key="VERSIONER_PERL_VERSION" value="5.8.9"\/>//' <dependency.xml > dependency-tmp.xml; 
    mv dependency-tmp.xml dependency.xml;
    br;
    rake components;
    rake ecom;
    gg;
    cd build/buildeng;
    git checkout dependency.xml;
} 
